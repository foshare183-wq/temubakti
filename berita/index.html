<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8">
  <title>Kabar Temu Bakti PMI Malut</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Portal Berita dan Dokumentasi Kegiatan Temu Bakti PMI Malut">
  
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
  
  <script>tailwind.config = { theme: { extend: { fontFamily: { sans: ['"Plus Jakarta Sans"', 'sans-serif'] } } } }</script>
  <style>
    body { background-color: #f8fafc; }
    .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .line-clamp-3 { display: -webkit-box; -webkit-line-clamp: 3; -webkit-box-orient: vertical; overflow: hidden; }
    .loader { border: 3px solid #e2e8f0; border-top: 3px solid #dc2626; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
  </style>
</head>
<body class="text-slate-800 font-sans min-h-screen flex flex-col">

  <nav class="bg-white/80 backdrop-blur-md border-b border-slate-200 sticky top-0 z-40">
      <div class="max-w-6xl mx-auto px-4 py-3 flex justify-between items-center">
          <div class="flex items-center gap-3">
              <img src="https://afbhvfhdjozvypeehgjo.supabase.co/storage/v1/object/public/TB%20PMI/logo%20temu%20bakti.png" class="h-10 w-auto">
              <div>
                  <h1 class="font-bold text-slate-900 text-sm md:text-base leading-tight">TEMU BAKTI</h1>
                  <p class="text-[10px] md:text-xs text-red-600 font-bold tracking-wider uppercase">PMI Prov. Maluku Utara</p>
              </div>
          </div>
          <a href="/" class="bg-slate-900 hover:bg-red-600 text-white text-xs md:text-sm font-bold px-4 py-2 rounded-full transition flex items-center gap-2">
              <i class="bi bi-person-fill"></i> <span class="hidden sm:inline">LOGIN PESERTA</span>
          </a>
      </div>
  </nav>

  <header class="bg-white border-b border-slate-200 py-12 px-4 text-center">
      <h2 class="text-3xl md:text-5xl font-extrabold text-slate-900 mb-4 tracking-tight">Kabar <span class="text-transparent bg-clip-text bg-gradient-to-r from-red-600 to-red-400">Temu Bakti</span></h2>
      <p class="text-slate-500 max-w-xl mx-auto text-sm md:text-lg">Dokumentasi kegiatan, opini, dan karya jurnalistik remaja dari seluruh unit PMR di Maluku Utara.</p>
  </header>

  <main class="flex-1 max-w-6xl mx-auto px-4 py-8 w-full">
      <div id="newsContainer" class="min-h-[300px]">
          <div class="text-center py-20"><div class="loader mx-auto"></div><p class="mt-4 text-slate-400 text-sm">Memuat berita...</p></div>
      </div>
  </main>

  <footer class="bg-white border-t border-slate-200 py-8 text-center mt-auto">
      <p class="text-slate-400 text-xs font-bold">© 2026 Panitia Temu Bakti PMI Maluku Utara</p>
      <div class="flex justify-center gap-4 mt-4 text-slate-300">
          <i class="bi bi-instagram hover:text-red-500 cursor-pointer transition"></i>
          <i class="bi bi-facebook hover:text-blue-600 cursor-pointer transition"></i>
          <i class="bi bi-youtube hover:text-red-600 cursor-pointer transition"></i>
      </div>
  </footer>

  <div id="modalBerita" class="fixed inset-0 z-[100] bg-slate-900/90 backdrop-blur-sm hidden overflow-y-auto">
      <div class="min-h-screen flex items-center justify-center p-4">
          <div class="bg-white w-full max-w-2xl rounded-2xl overflow-hidden shadow-2xl relative">
              <button onclick="closeBerita()" class="absolute top-4 right-4 z-20 w-10 h-10 bg-black/50 hover:bg-red-600 rounded-full text-white flex items-center justify-center transition"><i class="bi bi-x-lg"></i></button>
              
              <div class="h-64 md:h-80 w-full bg-slate-200 relative">
                  <img id="viewFoto" class="w-full h-full object-cover">
              </div>
              
              <div class="p-8">
                  <span id="viewKategori" class="text-[10px] font-bold text-white bg-blue-600 px-3 py-1 rounded-full uppercase tracking-wider mb-3 inline-block">BERITA</span>
                  <h1 id="viewJudul" class="text-2xl md:text-3xl font-extrabold text-slate-900 leading-tight mb-4">Judul Berita</h1>
                  
                  <div class="flex items-center gap-3 text-xs text-slate-500 font-bold border-b border-slate-100 pb-6 mb-6">
                      <div class="w-8 h-8 rounded-full bg-slate-100 flex items-center justify-center"><i class="bi bi-person-fill"></i></div>
                      <div>
                          <p id="viewPenulis" class="text-slate-800">Penulis</p>
                          <p id="viewTanggal" class="font-normal">Tanggal</p>
                      </div>
                  </div>
                  
                  <div id="viewIsi" class="prose prose-slate max-w-none text-slate-700 leading-relaxed whitespace-pre-wrap">
                      Isi konten...
                  </div>

                  <div class="mt-8 pt-6 border-t border-slate-100 text-center">
                      <button onclick="closeBerita()" class="px-6 py-2 bg-slate-100 hover:bg-slate-200 text-slate-700 rounded-lg font-bold text-sm transition">Tutup Berita</button>
                  </div>
              </div>
          </div>
      </div>
  </div>

  <script>
    // ⚠️ GANTI DENGAN URL SCRIPT NEWSROOM (Script B) ANDA ⚠️
    const GAS_NEWS_URL = "https://script.google.com/macros/s/AKfycbx693z5rUDTuE8_GrkvSeXOwt60OzIBSgQ64aMr20V00iUQz_wylG8JfMWprcfV3xOHjw/exec"; 

    let NEWS_CACHE = [];

    // Load Data saat halaman dibuka
    window.onload = loadNews;

    async function loadNews() {
        const container = document.getElementById('newsContainer');
        try {
            // Panggil API Newsroom
            const response = await fetch(GAS_NEWS_URL, {
                method: 'POST',
                body: JSON.stringify({ action: 'get_mading_public' })
            });
            const res = await response.json();

            if(res.success && res.data.length > 0) {
                NEWS_CACHE = res.data;
                renderNews(res.data);
            } else {
                container.innerHTML = `<div class="text-center py-20"><p class="text-slate-400 font-bold">Belum ada berita tayang.</p></div>`;
            }
        } catch (e) {
            container.innerHTML = `<div class="text-center py-20"><p class="text-red-400">Gagal memuat berita.</p></div>`;
        }
    }

    function renderNews(data) {
        const c = document.getElementById('newsContainer');
        const [hero, ...others] = data;
        let html = '';

        // 1. HERO SECTION (Berita Terbaru Besar)
        if(hero) {
            html += `
            <div onclick="openBerita(${hero.id})" class="group cursor-pointer mb-12 relative rounded-3xl overflow-hidden shadow-xl aspect-[16/9] md:aspect-[21/9]">
                <img src="${hero.foto_url}" class="w-full h-full object-cover group-hover:scale-105 transition duration-700 ease-out">
                <div class="absolute inset-0 bg-gradient-to-t from-black/90 via-black/20 to-transparent"></div>
                <div class="absolute bottom-0 left-0 p-6 md:p-10 w-full md:w-2/3">
                    <span class="bg-red-600 text-white text-[10px] md:text-xs font-bold px-3 py-1 rounded-full mb-3 inline-block shadow-lg">TERBARU</span>
                    <h2 class="text-white text-2xl md:text-4xl font-extrabold leading-tight mb-2 drop-shadow-md group-hover:text-red-200 transition">${hero.judul}</h2>
                    <p class="text-slate-300 text-sm md:text-base line-clamp-2 hidden md:block mb-4">${hero.isi_berita || ''}</p>
                    <div class="flex items-center gap-2 text-white/80 text-xs font-bold">
                        <i class="bi bi-pen"></i> ${hero.penulis} • ${formatDate(hero.created_at)}
                    </div>
                </div>
            </div>
            
            <div class="flex items-center gap-4 mb-8">
                <h3 class="font-bold text-slate-800 text-xl">Berita Lainnya</h3>
                <div class="h-px bg-slate-200 flex-1"></div>
            </div>`;
        }

        // 2. GRID LIST (Sisa Berita)
        html += '<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">';
        
        others.forEach(item => {
            let badgeClass = "bg-blue-100 text-blue-700";
            if(item.kategori === 'Opini') badgeClass = "bg-purple-100 text-purple-700";
            if(item.kategori === 'Sastra') badgeClass = "bg-pink-100 text-pink-700";

            // Gunakan parameter =s400 untuk thumbnail yang ringan tapi tajam
            html += `
            <div onclick="openBerita(${item.id})" class="bg-white rounded-2xl border border-slate-100 shadow-sm hover:shadow-lg transition cursor-pointer flex flex-col overflow-hidden group h-full">
                <div class="h-48 overflow-hidden relative">
                    <img src="${item.foto_url}=s400" class="w-full h-full object-cover group-hover:scale-110 transition duration-500" loading="lazy">
                    <div class="absolute top-3 left-3">
                         <span class="text-[10px] font-bold px-2 py-1 rounded-md ${badgeClass} uppercase tracking-wider shadow-sm">${item.kategori}</span>
                    </div>
                </div>
                <div class="p-5 flex-1 flex flex-col">
                    <h3 class="font-bold text-slate-800 text-lg leading-snug mb-2 group-hover:text-red-600 transition line-clamp-2">${item.judul}</h3>
                    <div class="mt-auto pt-4 flex items-center justify-between border-t border-slate-50 text-xs text-slate-400">
                        <span class="font-bold text-slate-600 flex items-center gap-1"><i class="bi bi-person-fill"></i> ${item.penulis.split(' ')[0]}</span>
                        <span>${formatDate(item.created_at)}</span>
                    </div>
                </div>
            </div>`;
        });
        
        html += '</div>';
        c.innerHTML = html;
    }

    function openBerita(id) {
        const item = NEWS_CACHE.find(i => i.id === id);
        if(!item) return;
        document.getElementById('viewFoto').src = item.foto_url;
        document.getElementById('viewKategori').innerText = item.kategori;
        document.getElementById('viewJudul').innerText = item.judul;
        document.getElementById('viewPenulis').innerText = item.penulis;
        document.getElementById('viewTanggal').innerText = formatDate(item.created_at);
        document.getElementById('viewIsi').innerText = item.isi_berita;
        
        const modal = document.getElementById('modalBerita');
        modal.classList.remove('hidden');
        document.body.style.overflow = 'hidden'; // Stop scroll body
    }

    function closeBerita() {
        document.getElementById('modalBerita').classList.add('hidden');
        document.body.style.overflow = 'auto'; // Restore scroll
    }

    function formatDate(iso) {
        if(!iso) return '-';
        return new Date(iso).toLocaleDateString('id-ID', {day: 'numeric', month: 'long', year: 'numeric'});
    }
  </script>
</body>
</html>
